<script type="module">
  const connectButton = document.getElementById('connectButton');
  const status = document.getElementById('status');

  const contractAddress = '0x64a5DAc06c32689D34336b4b0f5f3B8b8CDcB495'; // msakai-membership-2025

  connectButton.addEventListener('click', async () => {
    if (typeof window.ethereum === 'undefined') {
      alert('MetaMaskがインストールされていません。');
      return;
    }

    try {
      const accounts = await ethereum.request({ method: 'eth_requestAccounts' });
      const account = accounts[0];
      status.innerText = `接続済み: ${account}`;

      const options = { method: 'GET', headers: { accept: 'application/json' } };
      const url = `https://api.opensea.io/api/v2/chain/polygon/account/${account}/nfts?contract_address=${contractAddress}`;

      const response = await fetch(url, options);
      const data = await response.json();

      if (data.nfts && data.nfts.length > 0) {
        window.location.href = 'nightmare.html';
      } else {
        alert('このNFTを保有していません。');
      }

    } catch (err) {
      console.error(err);
      status.innerText = '接続に失敗しました。';
    }
  });
</script>








