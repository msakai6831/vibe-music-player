<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>NFTèªè¨¼ãƒšãƒ¼ã‚¸</title>
  <script src="https://cdn.jsdelivr.net/npm/@thirdweb-dev/sdk@4.0.0/dist/browser/index.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
</head>
<body>
  <h1>ğŸ§ ãƒŠã‚¤ãƒˆãƒ¡ã‚¢å†ç”Ÿãƒšãƒ¼ã‚¸ï¼ˆNFTä¿æœ‰è€…é™å®šï¼‰</h1>
  <button onclick="connectWallet()">MetaMaskã§ãƒ­ã‚°ã‚¤ãƒ³</button>
  <p id="status"></p>

  <script>
    const CONTRACT_ADDRESS = "0x64a5DAc06c32689D34336b4b0f5f3B8b8CDcB495";
    const NFT_TOKEN_ID = "0"; // è¤‡æ•°ã‚ã‚‹å ´åˆã¯å‹•çš„å¯¾å¿œã‚‚å¯

    async function connectWallet() {
      if (!window.ethereum) {
        alert("MetaMaskã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ã€‚");
        return;
      }

      const provider = new ethers.providers.Web3Provider(window.ethereum);
      await provider.send("eth_requestAccounts", []);
      const signer = provider.getSigner();
      const userAddress = await signer.getAddress();
      const sdk = new thirdweb.ThirdwebSDK("polygon");

      const nftCollection = await sdk.getContract(CONTRACT_ADDRESS, "nft-collection");
      const balance = await nftCollection.balanceOf(userAddress, NFT_TOKEN_ID);

      if (balance.gt(0)) {
        document.getElementById("status").innerText = "èªè¨¼æˆåŠŸï¼ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆä¸­...";
        window.location.href = "nightmare.html";
      } else {
        document.getElementById("status").innerText = "ã“ã®NFTã‚’ä¿æœ‰ã—ã¦ã„ãªã„ãŸã‚ã€ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã›ã‚“ã€‚";
      }
    }
  </script>
</body>
</html>
